"use strict";(globalThis.webpackChunkdocs_site=globalThis.webpackChunkdocs_site||[]).push([[192],{6928(e,n,i){i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"RUNBOOK","title":"Runbook","description":"Overview","source":"@site/docs/RUNBOOK.md","sourceDirName":".","slug":"/RUNBOOK","permalink":"/data-governance-pipeline/docs/RUNBOOK","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8},"sidebar":"tutorialSidebar","previous":{"title":"Architecture","permalink":"/data-governance-pipeline/docs/ARCHITECTURE"},"next":{"title":"Changelog","permalink":"/data-governance-pipeline/docs/CHANGELOG"}}');var s=i(4848),t=i(8453);const l={sidebar_position:8},d="Runbook",a={},c=[{value:"Overview",id:"overview",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Setup",id:"setup",level:2},{value:"1. Clone the Repository",id:"1-clone-the-repository",level:3},{value:"2. Create Virtual Environment",id:"2-create-virtual-environment",level:3},{value:"3. Install Dependencies",id:"3-install-dependencies",level:3},{value:"4. Verify Setup",id:"4-verify-setup",level:3},{value:"Running the Pipeline",id:"running-the-pipeline",level:2},{value:"Full Pipeline Run (recommended)",id:"full-pipeline-run-recommended",level:3},{value:"Custom Row Limit",id:"custom-row-limit",level:3},{value:"Individual Modules",id:"individual-modules",level:3},{value:"Expected Output",id:"expected-output",level:2},{value:"Output Files",id:"output-files",level:3},{value:"Verifying a Successful Run",id:"verifying-a-successful-run",level:2},{value:"Check Row Count in Database",id:"check-row-count-in-database",level:3},{value:"Check Lineage Log",id:"check-lineage-log",level:3},{value:"Check DQ Report",id:"check-dq-report",level:3},{value:"Spot Check Data",id:"spot-check-data",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Connection Error \u2014 API Unreachable",id:"connection-error--api-unreachable",level:3},{value:"HTTP Error from API",id:"http-error-from-api",level:3},{value:"Pandas Deprecation Warning",id:"pandas-deprecation-warning",level:3},{value:"SQLite Database Locked",id:"sqlite-database-locked",level:3},{value:"Module Not Found Error",id:"module-not-found-error",level:3},{value:"Virtual Environment Not Activated",id:"virtual-environment-not-activated",level:3},{value:"Maintenance",id:"maintenance",level:2},{value:"Update Dependencies",id:"update-dependencies",level:3},{value:"Re-run Pipeline After Schema Change",id:"re-run-pipeline-after-schema-change",level:3},{value:"Regenerate Database",id:"regenerate-database",level:3}];function o(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"runbook",children:"Runbook"})}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"This runbook provides step-by-step instructions for setting up, running, and troubleshooting the Data Governance Pipeline. Follow this guide to get the pipeline running from a fresh clone."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Requirement"}),(0,s.jsx)(n.th,{children:"Version"}),(0,s.jsx)(n.th,{children:"Notes"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Python"}),(0,s.jsx)(n.td,{children:"3.11.5+"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://www.python.org/downloads/",children:"Download"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Git"}),(0,s.jsx)(n.td,{children:"Any"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"https://git-scm.com/",children:"Download"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Internet connection"}),(0,s.jsx)(n.td,{children:"\u2014"}),(0,s.jsx)(n.td,{children:"Required for NYC Open Data API"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"setup",children:"Setup"}),"\n",(0,s.jsx)(n.h3,{id:"1-clone-the-repository",children:"1. Clone the Repository"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/Escuhlade/data-governance-pipeline.git\ncd data-governance-pipeline\n"})}),"\n",(0,s.jsx)(n.h3,{id:"2-create-virtual-environment",children:"2. Create Virtual Environment"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"python -m venv venv\nsource venv/bin/activate  # Mac/Linux\nvenv\\Scripts\\activate     # Windows\n"})}),"\n",(0,s.jsxs)(n.p,{children:["You should see ",(0,s.jsx)(n.code,{children:"(venv)"})," in your terminal prompt."]}),"\n",(0,s.jsx)(n.h3,{id:"3-install-dependencies",children:"3. Install Dependencies"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"pip install -r requirements.txt\n"})}),"\n",(0,s.jsx)(n.h3,{id:"4-verify-setup",children:"4. Verify Setup"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"python -c \"import pandas, requests; print('Setup complete')\"\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Should print ",(0,s.jsx)(n.code,{children:"Setup complete"})," with no errors."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"running-the-pipeline",children:"Running the Pipeline"}),"\n",(0,s.jsx)(n.h3,{id:"full-pipeline-run-recommended",children:"Full Pipeline Run (recommended)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"python main.py\n"})}),"\n",(0,s.jsx)(n.p,{children:"Runs with default limit of 1,000 rows."}),"\n",(0,s.jsx)(n.h3,{id:"custom-row-limit",children:"Custom Row Limit"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"python main.py --limit 5000\n"})}),"\n",(0,s.jsx)(n.h3,{id:"individual-modules",children:"Individual Modules"}),"\n",(0,s.jsx)(n.p,{children:"Run each module independently for testing or debugging:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# From the pipeline/ directory\ncd pipeline\n\n# Test extraction only\npython extract.py\n\n# Test transform only\npython transform.py\n\n# Test DQ checks only\npython dq_checks.py\n\n# Test load only\npython load.py\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"expected-output",children:"Expected Output"}),"\n",(0,s.jsx)(n.p,{children:"A successful pipeline run looks like this:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"============================================================\nNYC 311 DATA GOVERNANCE PIPELINE \u2014 STARTING\nRun timestamp: 2026-02-24T01:45:59\nRow limit: 5,000\n============================================================\n[STEP 1/4] Extract\nExtraction successful \u2014 5,000 rows, 44 columns\n[STEP 2/4] Transform\nTransformation complete \u2014 5,000 rows, 36 columns\n[STEP 3/4] DQ Checks\nDQ checks complete \u2014 PASS: 3 | FAIL: 1 | WARN: 2\n[STEP 4/4] Load\nLoad successful \u2014 4,970 rows written to 'nyc311_clean'\n============================================================\nPIPELINE COMPLETE\nDuration: 1.90 seconds\nRows extracted: 5,000\nRows after DQ: 4,970\nRows dropped: 30\n============================================================\n"})}),"\n",(0,s.jsx)(n.h3,{id:"output-files",children:"Output Files"}),"\n",(0,s.jsx)(n.p,{children:"After a successful run you will find:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"File"}),(0,s.jsx)(n.th,{children:"Location"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"nyc311.db"}),(0,s.jsx)(n.td,{children:"reports/nyc311.db"}),(0,s.jsx)(n.td,{children:"SQLite database with clean data"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"dq_report_TIMESTAMP.csv"}),(0,s.jsx)(n.td,{children:"reports/"}),(0,s.jsx)(n.td,{children:"DQ report for this run"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"verifying-a-successful-run",children:"Verifying a Successful Run"}),"\n",(0,s.jsx)(n.h3,{id:"check-row-count-in-database",children:"Check Row Count in Database"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'from pipeline.load import query\nprint(query("SELECT COUNT(*) as count FROM nyc311_clean"))\n'})}),"\n",(0,s.jsx)(n.h3,{id:"check-lineage-log",children:"Check Lineage Log"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'from pipeline.load import query\nprint(query("SELECT * FROM lineage_log"))\n'})}),"\n",(0,s.jsx)(n.h3,{id:"check-dq-report",children:"Check DQ Report"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ls reports/\ncat reports/dq_report_TIMESTAMP.csv\n"})}),"\n",(0,s.jsx)(n.h3,{id:"spot-check-data",children:"Spot Check Data"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'from pipeline.load import query\n\n# Top complaint types\nprint(query("""\n    SELECT complaint_type, COUNT(*) as count\n    FROM nyc311_clean\n    GROUP BY complaint_type\n    ORDER BY count DESC\n    LIMIT 5\n"""))\n\n# Complaints by borough\nprint(query("""\n    SELECT borough, COUNT(*) as count\n    FROM nyc311_clean\n    GROUP BY borough\n    ORDER BY count DESC\n"""))\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsx)(n.h3,{id:"connection-error--api-unreachable",children:"Connection Error \u2014 API Unreachable"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ERROR: Connection failed \u2014 could not reach NYC Open Data API\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause:"})," No internet connection or NYC Open Data API is down.",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Fix:"})," Check internet connection. Visit ",(0,s.jsx)(n.a,{href:"https://data.cityofnewyork.us",children:"https://data.cityofnewyork.us"})," to verify API is up. Retry after a few minutes."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"http-error-from-api",children:"HTTP Error from API"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ERROR: HTTP error from API: 429 Too Many Requests\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause:"})," Rate limited by NYC Open Data API.",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Fix:"})," Wait 60 seconds and retry. Reduce ",(0,s.jsx)(n.code,{children:"--limit"})," to a smaller value."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"pandas-deprecation-warning",children:"Pandas Deprecation Warning"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Pandas4Warning: For backward compatibility, 'str' dtypes are included...\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause:"})," Pandas version compatibility in transform.py.",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Fix:"})," Already handled \u2014 ",(0,s.jsx)(n.code,{children:'select_dtypes(include=["object", "str"])'})," resolves this."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"sqlite-database-locked",children:"SQLite Database Locked"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ERROR: SQLite error: database is locked\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause:"})," Another process has the database open.",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Fix:"})," Close any SQLite browser tools (e.g. DB Browser for SQLite) and retry."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"module-not-found-error",children:"Module Not Found Error"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"ModuleNotFoundError: No module named 'pandas'\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Cause:"})," Virtual environment not activated or dependencies not installed.",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Fix:"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"source venv/bin/activate\npip install -r requirements.txt\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h3,{id:"virtual-environment-not-activated",children:"Virtual Environment Not Activated"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Symptom:"})," You don't see ",(0,s.jsx)(n.code,{children:"(venv)"})," in your terminal prompt.",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Fix:"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"source venv/bin/activate  # Mac/Linux\nvenv\\Scripts\\activate     # Windows\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"maintenance",children:"Maintenance"}),"\n",(0,s.jsx)(n.h3,{id:"update-dependencies",children:"Update Dependencies"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'pip install --upgrade pandas requests python-dotenv\npip freeze > requirements.txt\ngit add requirements.txt\ngit commit -m "chore: update dependencies"\ngit push origin main\n'})}),"\n",(0,s.jsx)(n.h3,{id:"re-run-pipeline-after-schema-change",children:"Re-run Pipeline After Schema Change"}),"\n",(0,s.jsx)(n.p,{children:"If the NYC 311 API changes its schema:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Run ",(0,s.jsx)(n.code,{children:"python pipeline/extract.py"})," and check logged column names"]}),"\n",(0,s.jsxs)(n.li,{children:["Update ",(0,s.jsx)(n.code,{children:"COLUMNS_TO_DROP"})," in ",(0,s.jsx)(n.code,{children:"transform.py"})," if needed"]}),"\n",(0,s.jsxs)(n.li,{children:["Update ",(0,s.jsx)(n.code,{children:"DATE_COLUMNS"})," in ",(0,s.jsx)(n.code,{children:"transform.py"})," if needed"]}),"\n",(0,s.jsxs)(n.li,{children:["Update ",(0,s.jsx)(n.code,{children:"DATA_DICTIONARY.md"})," to reflect schema changes"]}),"\n",(0,s.jsxs)(n.li,{children:["Re-run full pipeline with ",(0,s.jsx)(n.code,{children:"python main.py"})]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"regenerate-database",children:"Regenerate Database"}),"\n",(0,s.jsxs)(n.p,{children:["If ",(0,s.jsx)(n.code,{children:"nyc311.db"})," becomes corrupted or needs a fresh rebuild:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"rm reports/nyc311.db\npython main.py\n"})}),"\n",(0,s.jsx)(n.p,{children:"The database is fully rebuilt on every pipeline run."})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}}}]);